---
title: "Machine Learning with TensorFlow and R"
output: 
  ioslides_presentation:
    widescreen: true
    smaller: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = FALSE)
```

## Overview

- TensorFlow Basics

- R Interfaces to TensorFlow

- Deep Learning

- Case Studies

- Learning More

## What is TensorFlow? | *A general purpose numerical computing library*

- Hardware independent
    - CPU (via C++ library [Eigen](http://eigen.tuxfamily.org/))
    - GPU (via [CUDA](https://en.wikipedia.org/wiki/CUDA))
    - TPU ([Tenor Processing Unit](https://en.wikipedia.org/wiki/Tensor_processing_unit))
    - Others...
    
- Supports distributed execution and very large datasets

- Supports [automatic differentiation](https://en.wikipedia.org/wiki/Automatic_differentiation)

## What are tensors? | *Data stored in multidimensional arrays*

| Dimension | R object  | 
|---|---|
| 0D | `42` | 
| 1D | `c(42, 42, 42)` 
| 2D | `matrix(42, nrow = 2, ncol = 2)`  |
| 3D | `array(42, dim = c(2,3,2))` |
| 4D | `array(42, dim = c(2,3,2,3))` |

## Some examples

- *Vector data*—2D tensors of shape `(samples, features)`
 
- *Timeseries or sequence data*—3D tensors of shape `(samples, timesteps,
features)`
 
- *Images*—4D tensors of shape `(samples, height, width, channels)`


- *Video*—5D tensors of shape `(samples, frames, height, width, channels)` 


## 2D Tensors | *Vector data*

```{r, echo = TRUE}
head(data.matrix(iris), n = 10)
```
```
      Sepal.Length Sepal.Width Petal.Length Petal.Width Species
 [1,]          5.1         3.5          1.4         0.2       1
 [2,]          4.9         3.0          1.4         0.2       1
 [3,]          4.7         3.2          1.3         0.2       1
 [4,]          4.6         3.1          1.5         0.2       1
 [5,]          5.0         3.6          1.4         0.2       1
 [6,]          5.4         3.9          1.7         0.4       1
 [7,]          4.6         3.4          1.4         0.3       1
 [8,]          5.0         3.4          1.5         0.2       1
 [9,]          4.4         2.9          1.4         0.2       1
[10,]          4.9         3.1          1.5         0.1       1
```

## 3D Tensors | *Timeseries or sequence data*

![](images/timeseries_data.png)


## 4D Tensors | *Image data*

![](images/image_data.png)


## TensorFlow for R&mdash;Packages {.smaller}

| Package | Description  | Release |
|---|--------------|--|
| [keras](https://tensorflow.rstudio.com/keras/)  | High-level interface for neural networks, with a focus on enabling fast experimentation.  | CRAN v2.1.3 |
| [tfestimators](https://tensorflow.rstudio.com/tfestimators/)  | High-level implementations of common model types such as regressors and classifiers. | CRAN v1.5 |
| [tensorflow](https://tensorflow.rstudio.com/tensorflow/)  |  Lower-level interface that provides full access to the TensorFlow computational graph. | CRAN v1.5 |
| [tfdatasets](https://tensorflow.rstudio.com/tools/tfdatasets/)  | Scalable input pipelines for TensorFlow models. | CRAN v1.5 |
| [tfruns](https://tensorflow.rstudio.com/tools/tfruns/)  | Track, visualize, and manage TensorFlow training runs and experiments. | CRAN v1.2 |
| [tfdeploy](https://tensorflow.rstudio.com/tools/tfdeploy/)  | Tools designed to make exporting and serving TensorFlow models straightforward.  | GitHub v0.5 |
| [cloudml](https://tensorflow.rstudio.com/tools/cloudml/)  | R interface to Google Cloud Machine Learning Engine.  | GitHub v0.5 |

## Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r cars, echo = TRUE}
summary(cars)
```

## Slide with Plot

```{r pressure}
plot(pressure)
```

